name: character_refine
version: "1.0"
description: "Refines a character based on quality feedback"
agent: world_quality
task: character_refine
is_system_prompt: false

template: |
  Improve this character based on quality feedback.

  IMPORTANT GUIDELINES:
  - Make targeted, minimal changes - do not rewrite the entire character
  - Preserve aspects that scored well in the evaluation
  - Focus improvement on the 1-2 lowest-scoring dimensions only
  - Keep the character's core identity, name, and distinguishing features intact

  ORIGINAL CHARACTER:
  Name: {{ character_name }}
  Role: {{ character_role }}
  Description: {{ character_description }}
  Traits: {{ character_traits | join(", ") }}
  Goals: {{ character_goals | join(", ") }}
  Arc Notes: {{ character_arc_notes }}

  QUALITY SCORES (0-10):
  - Depth: {{ scores.depth }}
  - Goals: {{ scores.goals }}
  - Flaws: {{ scores.flaws }}
  - Uniqueness: {{ scores.uniqueness }}
  - Arc Potential: {{ scores.arc_potential }}

  FEEDBACK: {{ scores.feedback }}

  WEAK AREAS TO IMPROVE: {{ weak_dimensions | join(", ") if weak_dimensions else "None - minor improvements only" }}

  Keep the name "{{ character_name }}" and role "{{ character_role }}", but enhance only the weak areas.
  Make the character more compelling while maintaining consistency.
  Write all text in {{ language }}.

variables:
  required:
    - character_name
    - character_role
    - character_description
    - character_traits
    - character_goals
    - character_arc_notes
    - scores
    - language
  optional:
    - weak_dimensions
